<!DOCTYPE html>
<html>
<head>
    <title>Tool Result Test</title>
    <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { margin: 10px; padding: 10px; background: #0078d4; color: white; border: none; cursor: pointer; }
        #result { margin-top: 20px; padding: 15px; background: #f0f0f0; border-radius: 4px; white-space: pre-wrap; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h2>Test InsertTableTool Result Format</h2>
    
    <button onclick="testInsertTable()">Test Insert Table</button>
    <button onclick="clearResult()">Clear</button>
    
    <div id="result">Ready to test...</div>
    
    <script>
        Office.initialize = function() {
            document.getElementById('result').innerText = 'Office initialized - Ready to test';
        };
        
        async function testInsertTable() {
            const resultDiv = document.getElementById('result');
            
            try {
                await Word.run(async (context) => {
                    // Simulate the InsertTableTool execute method
                    const params = {
                        rows: 2,
                        columns: 2,
                        position: "end",
                        data: [["1", "2"], ["3", "4"]],
                        style: "NoStyle",
                        border_style: "horizontal_only",
                        border_color: "#E0E0E0",
                        background_color: "transparent"
                    };
                    
                    // This is what the tool should return
                    const successMessage = `‚úÖ SUCCESS: Table created! A ${params.rows}x${params.columns} table is now at the end of the document.\n` +
                                          `üìç LOCATION: The table is at the end of the document. To see it, use find_tables tool.\n` +
                                          `üìä CONTENT: Table populated with your data.\n` +
                                          `üé® STYLE: White background with light grey horizontal borders.\n` +
                                          `‚ö†Ô∏è IMPORTANT: Use find_tables to verify the table. Do NOT create another table!`;
                    
                    const toolResult = {
                        success: true,
                        message: successMessage,
                        data: {
                            success: true,
                            table_created: true,
                            rows: params.rows,
                            columns: params.columns,
                            position: params.position,
                            location_description: "at the end of the document",
                            has_data: true,
                            next_step: "Use find_tables to verify the table was created"
                        },
                        changes: [{
                            type: "insert",
                            description: `‚úÖ Successfully created ${params.rows}x${params.columns} table at the end of the document`,
                            location: "at the end of the document"
                        }]
                    };
                    
                    // Display the result
                    resultDiv.className = 'success';
                    resultDiv.innerHTML = '<h3>Tool Result Structure:</h3>' + 
                                         '<pre>' + JSON.stringify(toolResult, null, 2) + '</pre>' +
                                         '<h3>What the model should see:</h3>' + 
                                         '<div style="background: white; padding: 10px; margin-top: 10px; border: 1px solid #ccc;">' +
                                         successMessage.replace(/\n/g, '<br>') + 
                                         '</div>';
                    
                    // Log to console
                    console.log('[Test] Tool Result:', toolResult);
                    console.log('[Test] Success Message:', successMessage);
                });
            } catch (error) {
                resultDiv.className = 'error';
                resultDiv.innerText = 'Error: ' + error.message;
            }
        }
        
        function clearResult() {
            document.getElementById('result').innerText = 'Ready to test...';
            document.getElementById('result').className = '';
        }
    </script>
</body>
</html>